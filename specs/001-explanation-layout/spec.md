# Feature Specification: 해설지 레이아웃 개선

**Feature Branch**: `001-explanation-layout`
**Created**: 2025-12-23
**Status**: Draft
**Input**: User description: "문제집 기능 - 해설지 레이아웃"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 해설지 PDF 출력 (Priority: P1)

교사가 문제집의 해설지를 PDF로 다운로드하여 학생들에게 배포할 수 있는 기능입니다. 해설지는 문제 유형별로 적절한 형식으로 정답과 해설을 보여주며, A4 용지에 최적화된 레이아웃으로 인쇄됩니다.

**Why this priority**: 해설지 생성은 문제집 모드의 핵심 기능으로, 학생들이 오답을 확인하고 학습할 수 있는 필수 자료입니다.

**Independent Test**: 문제 데이터 입력 후 "해설지" 뷰 모드로 전환하여 PDF 다운로드 버튼 클릭 시 정상적인 PDF 파일이 생성되는지 확인

**Acceptance Scenarios**:

1. **Given** 문제 데이터가 입력된 상태에서, **When** 사용자가 "해설지" 뷰 모드를 선택하면, **Then** 모든 문제의 정답과 해설이 표시된다
2. **Given** 해설지 뷰 모드에서, **When** PDF 다운로드 버튼을 클릭하면, **Then** A4 크기에 최적화된 해설지 PDF가 생성된다
3. **Given** 해설지 PDF를 실제로 인쇄하면, **When** 출력물을 확인했을 때, **Then** 모든 텍스트와 테이블이 잘려나가지 않고 완전히 표시된다

---

### User Story 2 - 유형별 해설 레이아웃 (Priority: P1)

7가지 문제 유형(어휘, 문법, 논리/빈칸, 대의파악, 삽입, 순서, 어휘적절성)별로 최적화된 해설 레이아웃을 제공합니다. 각 유형에 맞는 정보를 효과적으로 전달할 수 있도록 구성됩니다.

**Why this priority**: 문제 유형에 따라 필요한 해설 정보가 다르므로, 유형별 맞춤 레이아웃은 학습 효과를 극대화하는 데 필수적입니다.

**Independent Test**: 각 유형의 문제를 입력하고 해설지에서 해당 유형에 맞는 레이아웃이 표시되는지 확인

**Acceptance Scenarios**:

1. **Given** 어휘(동의어) 문제가 있을 때, **When** 해설지를 표시하면, **Then** 밑줄 단어, 정답 단어, 동의어 해설, 추가 동의어 목록이 표시된다
2. **Given** 문법 문제가 있을 때, **When** 해설지를 표시하면, **Then** 정답 변경사항, 출제 포인트, 정답/오답 해설이 표시된다
3. **Given** 빈칸/논리 문제가 있을 때, **When** 해설지를 표시하면, **Then** 정답 키워드, 빈칸 정체성, 핵심 단서가 표시된다
4. **Given** 대의파악(제목/요지) 문제가 있을 때, **When** 해설지를 표시하면, **Then** 중심 소재, 중심 내용, 정답 근거가 표시된다

---

### User Story 3 - 지문 번역 및 선지 번역 표시 (Priority: P2)

해설지에서 영어 지문의 한글 번역과 각 선지의 한글 번역을 함께 표시하여 학생들의 이해를 돕습니다.

**Why this priority**: 번역은 학습 보조 자료로, 기본 해설 기능이 완성된 후 추가되어야 합니다.

**Independent Test**: AI 해설 생성 후 해설지에서 지문 번역과 선지 번역이 올바르게 표시되는지 확인

**Acceptance Scenarios**:

1. **Given** AI 해설이 생성된 문제에서, **When** 해설지를 표시하면, **Then** 영어 지문 아래에 한글 번역이 표시된다
2. **Given** AI 해설이 생성된 문제에서, **When** 해설지를 표시하면, **Then** 각 선지의 한글 뜻이 함께 표시된다

---

### User Story 4 - Quick Answer 표 (Priority: P2)

해설지 첫 페이지에 모든 문제의 정답을 한눈에 볼 수 있는 빠른 정답표를 제공합니다.

**Why this priority**: 빠른 채점을 위한 편의 기능으로, 핵심 해설 기능 다음으로 중요합니다.

**Independent Test**: 해설지 뷰에서 Quick Answer 표가 첫 페이지에 표시되고 모든 문제의 정답이 올바르게 표시되는지 확인

**Acceptance Scenarios**:

1. **Given** 여러 문제가 입력된 상태에서, **When** 해설지를 표시하면, **Then** 첫 페이지에 7열 형식의 빠른 정답표가 표시된다 (행은 문제 수에 따라 자동 확장)
2. **Given** Quick Answer 표에서, **When** 특정 문제 번호를 확인하면, **Then** 해당 문제의 정답 번호(1-5)가 표시된다

---

### User Story 5 - 같은 지문 문제 그룹핑 (Priority: P3)

같은 지문을 공유하는 문제들(세트 문제)을 그룹으로 묶어 지문이 한 번만 표시되도록 합니다.

**Why this priority**: 레이아웃 최적화 기능으로, 기본 기능 완성 후 개선 사항입니다.

**Independent Test**: 같은 지문을 가진 연속된 문제들이 하나의 그룹으로 표시되고 지문이 중복 표시되지 않는지 확인

**Acceptance Scenarios**:

1. **Given** 같은 지문을 가진 2개의 연속 문제가 있을 때, **When** 해설지를 표시하면, **Then** 지문은 한 번만 표시되고 두 문제의 해설이 함께 표시된다
2. **Given** 지문이 없는 문제가 이전 문제 바로 뒤에 있을 때, **When** 해설지를 표시하면, **Then** 이전 문제의 지문을 상속받아 같은 그룹으로 처리된다

---

### Edge Cases

- 지문이 매우 긴 경우 페이지 분할이 자연스럽게 이루어져야 한다
- AI 해설이 아직 생성되지 않은 문제의 경우 플레이스홀더 텍스트가 표시되어야 한다
- 선지가 5개 미만인 문제도 정상적으로 처리되어야 한다
- 정답이 잘못된 형식(①-⑤가 아닌 경우)일 때 오류 없이 표시되어야 한다

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 시스템은 7가지 문제 유형별로 최적화된 해설 레이아웃을 제공해야 한다
- **FR-002**: 시스템은 정답을 일반 숫자(1-5) 형식으로 표시해야 한다
- **FR-003**: 시스템은 같은 지문을 공유하는 연속 문제를 그룹으로 묶어야 한다 (최대 2개)
- **FR-004**: 시스템은 지문 내 마크업(_word_, __________)을 시각적으로 구분하여 표시해야 한다
- **FR-005**: 시스템은 AI 해설이 없는 경우 적절한 플레이스홀더를 표시해야 한다
- **FR-006**: 시스템은 해설지를 A4 크기 PDF로 내보낼 수 있어야 한다
- **FR-007**: 시스템은 Quick Answer 표를 해설지 상단에 7열 형식으로 표시해야 한다 (행은 문제 수에 따라 자동 확장)
- **FR-008**: 시스템은 Pantone 컬러 팔레트를 해설지 디자인에 적용해야 한다
- **FR-009**: 시스템은 지문/선지 번역을 토글 설정으로 표시/숨김할 수 있어야 한다 (기본값: 표시)
- **FR-010**: 시스템은 글씨 크기 설정(0.85x ~ 1.2x)을 해설지에 반영해야 한다

### Key Entities

- **QuestionItem**: 문제 데이터 (id, 연도, 번호, 유형, 지문, 선지, 정답)
- **ExplanationData**: AI 해설 데이터 (7가지 유형별 해설 구조)
- **PassageGroup**: 같은 지문을 공유하는 문제 그룹
- **HeaderInfo**: 해설지 헤더 정보 (제목, 설명, 페이지 번호)

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자가 해설지 PDF를 3번의 클릭 이내에 다운로드할 수 있다
- **SC-002**: 해설지 PDF 생성 시간이 30문제 기준 10초 이내이다
- **SC-003**: 인쇄된 해설지에서 텍스트가 잘리거나 겹치는 현상이 0건이다
- **SC-004**: 7가지 문제 유형 모두 각각의 전용 레이아웃으로 표시된다
- **SC-005**: 같은 지문 문제의 지문 중복 표시가 제거되어 용지 사용량이 감소한다

## Assumptions

- 문제 데이터는 TSV 형식으로 입력되며, CLAUDE.md에 정의된 형식을 따른다
- 정답은 ①-⑤ 형식 또는 1-5 숫자 형식으로 입력된다
- AI 해설 생성은 별도 기능으로, 해설지 레이아웃은 해설 유무와 관계없이 동작한다
- Pretendard 폰트가 PDF 렌더링에 사용된다
- 브라우저에서 PDF 다운로드가 지원된다

## Clarifications

### Session 2025-12-23

- Q: 번역은 항상 표시할지, 사용자가 토글로 켜고 끌 수 있게 할지? → A: 토글 표시 - 사용자가 설정에서 번역 표시 여부를 선택 (기본값: 표시)
- Q: 35문제를 초과할 경우 Quick Answer 표를 어떻게 처리할지? → A: 자동 확장 - 문제 수에 맞게 행을 자동으로 추가 (7열 유지)
