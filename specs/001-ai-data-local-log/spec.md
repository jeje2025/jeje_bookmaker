# Feature Specification: AI 생성 데이터 로컬 기록

**Feature Branch**: `001-ai-data-local-log`
**Created**: 2025-12-23
**Status**: Draft
**Input**: User description: "AI 생성 데이터 로컬 기록"

## Clarifications

### Session 2025-12-23

- Q: 같은 문제 세트에 대해 AI 해설을 여러 번 생성할 경우 저장 방식? → A: localStorage 사용, 최근 2개 세션만 유지 (FIFO 방식으로 오래된 것 자동 삭제)

## User Scenarios & Testing *(mandatory)*

### User Story 1 - AI 생성 결과 자동 저장 (Priority: P1)

사용자가 문제 해설 생성을 요청하면, 시스템이 Gemini API 응답을 자동으로 로컬에 저장한다.

**Why this priority**: 핵심 기능으로, API 비용 절감과 데이터 재활용의 기반이 된다. 이 기능 없이는 다른 기능이 의미가 없다.

**Independent Test**: 문제 해설 생성 후 브라우저를 새로고침해도 저장된 데이터를 확인할 수 있으면 성공

**Acceptance Scenarios**:

1. **Given** 사용자가 문제 목록을 입력하고 API 키가 설정된 상태, **When** "AI 해설 생성" 버튼을 클릭하여 해설이 생성되면, **Then** 생성된 해설 데이터가 로컬 저장소에 자동으로 저장된다
2. **Given** AI 해설 생성이 완료된 상태, **When** 브라우저를 새로고침하거나 앱을 다시 열면, **Then** 이전에 저장된 해설 데이터를 불러올 수 있다
3. **Given** 단어장 생성 요청이 완료된 상태, **When** 생성이 완료되면, **Then** 단어 목록 데이터도 로컬 저장소에 자동으로 저장된다

---

### User Story 2 - 저장된 데이터 불러오기 (Priority: P2)

사용자가 이전에 저장된 AI 생성 데이터를 불러와 재사용할 수 있다.

**Why this priority**: 저장된 데이터의 활용 없이는 저장의 의미가 없다. P1 이후 반드시 필요한 기능이다.

**Independent Test**: 저장된 세션을 선택하여 불러오면 해당 데이터가 화면에 표시되면 성공

**Acceptance Scenarios**:

1. **Given** 하나 이상의 AI 생성 세션이 저장된 상태, **When** 사용자가 "저장된 데이터 불러오기"를 선택하면, **Then** 저장된 세션 목록이 표시된다
2. **Given** 저장된 세션 목록이 표시된 상태, **When** 특정 세션을 선택하면, **Then** 해당 세션의 문제 목록과 AI 해설이 앱에 복원된다
3. **Given** 저장된 데이터를 불러온 상태, **When** PDF 생성 버튼을 클릭하면, **Then** 불러온 데이터로 정상적으로 PDF가 생성된다

---

### User Story 3 - 저장된 데이터 관리 (Priority: P3)

사용자가 저장된 AI 생성 데이터를 확인하고 삭제할 수 있다.

**Why this priority**: 저장소 용량 관리와 데이터 정리를 위해 필요하지만, 핵심 워크플로우 이후에 해결해도 된다.

**Independent Test**: 저장된 세션을 삭제하면 목록에서 사라지고 더 이상 불러올 수 없으면 성공

**Acceptance Scenarios**:

1. **Given** 저장된 세션 목록이 표시된 상태, **When** 특정 세션의 삭제 버튼을 클릭하면, **Then** 해당 세션이 로컬 저장소에서 제거된다
2. **Given** 여러 세션이 저장된 상태, **When** "모두 삭제" 기능을 사용하면, **Then** 모든 저장된 세션이 삭제된다
3. **Given** 세션을 삭제한 상태, **When** 앱을 다시 로드하면, **Then** 삭제된 세션은 목록에 나타나지 않는다

---

### Edge Cases

- 로컬 저장소 용량이 부족할 경우 어떻게 처리하는가?
- 저장 중 브라우저가 비정상 종료되면 데이터 무결성이 어떻게 보장되는가?
- 저장된 데이터 형식이 앱 업데이트로 변경되면 이전 데이터를 어떻게 처리하는가?
- 같은 문제에 대해 여러 번 해설을 생성하면 어떻게 저장되는가?

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 시스템 MUST AI 해설 생성 완료 시 자동으로 로컬 저장소에 데이터를 저장한다
- **FR-002**: 시스템 MUST 저장된 세션 목록을 조회할 수 있는 인터페이스를 제공한다
- **FR-003**: 사용자 MUST be able to 저장된 세션을 선택하여 앱에 복원할 수 있다
- **FR-004**: 시스템 MUST 각 세션에 대해 다음 정보를 저장한다: 생성 일시, 문제 목록, AI 해설 데이터, 단어장 데이터(해당 시)
- **FR-005**: 사용자 MUST be able to 개별 세션 또는 전체 세션을 삭제할 수 있다
- **FR-006**: 시스템 MUST 저장소 용량 부족 시 사용자에게 알림을 표시한다
- **FR-007**: 시스템 MUST 저장된 데이터의 버전 정보를 포함하여 향후 호환성을 유지한다

### Key Entities

- **Session**: AI 생성 작업의 단위. 생성 일시, 세션 이름/설명, 문제 목록, 해설 데이터를 포함
- **QuestionItem**: 개별 문제 데이터. 지문, 보기, 정답, 카테고리 등 포함
- **ExplanationData**: AI가 생성한 해설 데이터. 문제 유형별로 다른 구조를 가짐
- **VocabularyData**: AI가 추출한 단어 목록. 단어, 뜻, 출처 문제 번호 포함

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자가 AI 해설 생성 후 1초 이내에 데이터가 자동 저장된다
- **SC-002**: 저장된 세션을 3초 이내에 완전히 복원할 수 있다
- **SC-003**: 저장소에 최근 2개의 세션을 저장할 수 있다
- **SC-004**: 앱 재시작 후에도 100% 데이터 무결성이 유지된다
- **SC-005**: 사용자가 API 재호출 없이 이전 세션을 재활용하여 반복 작업 시간을 80% 단축할 수 있다

## Assumptions

- 브라우저의 localStorage를 사용한다 (단순 구현)
- 최근 2개 세션만 유지하며, 새 세션 저장 시 가장 오래된 것을 자동 삭제한다 (FIFO)
- 사용자는 단일 브라우저에서 앱을 사용하며, 크로스 브라우저 동기화는 범위 밖이다
- 저장되는 데이터는 민감 정보를 포함하지 않으므로 암호화는 필요하지 않다
- 세션 이름은 자동 생성된다 (생성 일시 기반)
